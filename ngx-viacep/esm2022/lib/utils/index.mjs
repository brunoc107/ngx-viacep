import { CEPError } from '../model/cep-error';
import { CEPErrorCode } from '../model/cep-error-code';
import { UFS_VALIDAS } from '../model/constantes';
import { Observable } from 'rxjs';
const throwCepError = (error) => {
    throw new CEPError(error);
};
const ehStringValida = (data) => !!data && data.trim() !== '';
const hasMinLength = (data, minLength) => data.trim().length >= minLength;
const hasMaxLength = (data, maxLength) => data.trim().length <= maxLength;
const validarMunicipio = (municipio) => {
    if (!ehStringValida(municipio)) {
        throwCepError(CEPErrorCode.MUNICIPIO_VAZIO);
    }
    if (!hasMinLength(municipio, 3)) {
        throwCepError(CEPErrorCode.MUNICIPIO_MUITO_CURTO);
    }
};
const validarLogradouro = (logradouro) => {
    if (!ehStringValida(logradouro)) {
        throwCepError(CEPErrorCode.LOGRADOURO_VAZIO);
    }
    if (!hasMinLength(logradouro, 3)) {
        throwCepError(CEPErrorCode.LOGRADOURO_MUITO_CURTO);
    }
};
const validarUF = (uf) => {
    if (!ehStringValida(uf)) {
        throwCepError(CEPErrorCode.UF_VAZIA);
    }
    if (!hasMinLength(uf, 2)) {
        throwCepError(CEPErrorCode.UF_MUITO_CURTA);
    }
    if (!hasMaxLength(uf, 2)) {
        throwCepError(CEPErrorCode.UF_MUITO_LONGA);
    }
    if (!UFS_VALIDAS.some((it) => it.toLowerCase() === uf.toLowerCase())) {
        throwCepError(CEPErrorCode.UF_NAO_EXISTE);
    }
};
export const validarCEP = () => (source) => new Observable((subscriber) => source.subscribe({
    next: (cep) => {
        try {
            const regex = new RegExp(/^[0-9]+$/);
            if (!ehStringValida(cep)) {
                throwCepError(CEPErrorCode.CEP_VAZIO);
            }
            if (!regex.test(cep)) {
                throwCepError(CEPErrorCode.CEP_INVALIDO);
            }
            if (cep.length < 8) {
                throwCepError(CEPErrorCode.CEP_MUITO_CURTO);
            }
            if (cep.length > 8) {
                throwCepError(CEPErrorCode.CEP_MUITO_LONGO);
            }
            subscriber.next(cep.trim());
        }
        catch (e) {
            subscriber.error(e);
        }
    },
    error: (error) => subscriber.error(error),
    complete: () => subscriber.complete(),
}));
export const validarEndereco = () => (source) => new Observable((subscriber) => source.subscribe({
    next: ({ uf, logradouro, municipio }) => {
        try {
            validarUF(uf);
            validarMunicipio(municipio);
            validarLogradouro(logradouro);
        }
        catch (e) {
            subscriber.error(e);
        }
        subscriber.next({ uf, logradouro, municipio });
    },
    error: (error) => subscriber.error(error),
    complete: () => subscriber.complete(),
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9icnVub2Mvbmd4LXZpYWNlcC9zcmMvbGliL3V0aWxzL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM5QyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFbEMsTUFBTSxhQUFhLEdBQUcsQ0FBQyxLQUFtQixFQUFFLEVBQUU7SUFDNUMsTUFBTSxJQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUM1QixDQUFDLENBQUM7QUFFRixNQUFNLGNBQWMsR0FBRyxDQUFDLElBQVksRUFBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDO0FBRS9FLE1BQU0sWUFBWSxHQUFHLENBQUMsSUFBWSxFQUFFLFNBQWlCLEVBQVcsRUFBRSxDQUNoRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxJQUFJLFNBQVMsQ0FBQztBQUVsQyxNQUFNLFlBQVksR0FBRyxDQUFDLElBQVksRUFBRSxTQUFpQixFQUFXLEVBQUUsQ0FDaEUsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sSUFBSSxTQUFTLENBQUM7QUFFbEMsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLFNBQWlCLEVBQVEsRUFBRTtJQUNuRCxJQUFJLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1FBQzlCLGFBQWEsQ0FBQyxZQUFZLENBQUMsZUFBZSxDQUFDLENBQUM7S0FDN0M7SUFFRCxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMs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TUFBTSxDQUFDLFNBQVMsQ0FBQztJQUNmLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFO1FBQ3RDLElBQUk7WUFDRixTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDZCxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM1QixpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztTQUMvQjtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1YsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNyQjtRQUNELFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNELEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7SUFDekMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUU7Q0FDdEMsQ0FBQyxDQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDRVBFcnJvciB9IGZyb20gJy4uL21vZGVsL2NlcC1lcnJvcic7XG5pbXBvcnQgeyBDRVBFcnJvckNvZGUgfSBmcm9tICcuLi9tb2RlbC9jZXAtZXJyb3ItY29kZSc7XG5pbXBvcnQgeyBVRlNfVkFMSURBUyB9IGZyb20gJy4uL21vZGVsL2NvbnN0YW50ZXMnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuXG5jb25zdCB0aHJvd0NlcEVycm9yID0gKGVycm9yOiBDRVBFcnJvckNvZGUpID0+IHtcbiAgdGhyb3cgbmV3IENFUEVycm9yKGVycm9yKTtcbn07XG5cbmNvbnN0IGVoU3RyaW5nVmFsaWRhID0gKGRhdGE6IHN0cmluZyk6IGJvb2xlYW4gPT4gISFkYXRhICYmIGRhdGEudHJpbSgpICE9PSAnJztcblxuY29uc3QgaGFzTWluTGVuZ3RoID0gKGRhdGE6IHN0cmluZywgbWluTGVuZ3RoOiBudW1iZXIpOiBib29sZWFuID0+XG4gIGRhdGEudHJpbSgpLmxlbmd0aCA+PSBtaW5MZW5ndGg7XG5cbmNvbnN0IGhhc01heExlbmd0aCA9IChkYXRhOiBzdHJpbmcsIG1heExlbmd0aDogbnVtYmVyKTogYm9vbGVhbiA9PlxuICBkYXRhLnRyaW0oKS5sZW5ndGggPD0gbWF4TGVuZ3RoO1xuXG5jb25zdCB2YWxpZGFyTXVuaWNpcGlvID0gKG11bmljaXBpbzogc3RyaW5nKTogdm9pZCA9PiB7XG4gIGlmICghZWhTdHJpbmdWYWxpZGEobXVuaWNpcGlvKSkge1xuICAgIHRocm93Q2VwRXJyb3IoQ0VQRXJyb3JDb2RlLk1VTklDSVBJT19WQVpJTyk7XG4gIH1cblxuICBpZiAoIWhhc01pbkxlbmd0aChtdW5pY2lwaW8sIDMpKSB7XG4gICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuTVVOSUNJUElPX01VSVRPX0NVUlRPKTtcbiAgfVxufTtcblxuY29uc3QgdmFsaWRhckxvZ3JhZG91cm8gPSAobG9ncmFkb3Vybzogc3RyaW5nKTogdm9pZCA9PiB7XG4gIGlmICghZWhTdHJpbmdWYWxpZGEobG9ncmFkb3VybykpIHtcbiAgICB0aHJvd0NlcEVycm9yKENFUEVycm9yQ29kZS5MT0dSQURPVVJPX1ZBWklPKTtcbiAgfVxuXG4gIGlmICghaGFzTWluTGVuZ3RoKGxvZ3JhZG91cm8sIDMpKSB7XG4gICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuTE9HUkFET1VST19NVUlUT19DVVJUTyk7XG4gIH1cbn07XG5cbmNvbnN0IHZhbGlkYXJVRiA9ICh1Zjogc3RyaW5nKTogdm9pZCA9PiB7XG4gIGlmICghZWhTdHJpbmdWYWxpZGEodWYpKSB7XG4gICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuVUZfVkFaSUEpO1xuICB9XG5cbiAgaWYgKCFoYXNNaW5MZW5ndGgodWYsIDIpKSB7XG4gICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuVUZfTVVJVE9fQ1VSVEEpO1xuICB9XG5cbiAgaWYgKCFoYXNNYXhMZW5ndGgodWYsIDIpKSB7XG4gICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuVUZfTVVJVE9fTE9OR0EpO1xuICB9XG5cbiAgaWYgKCFVRlNfVkFMSURBUy5zb21lKChpdCkgPT4gaXQudG9Mb3dlckNhc2UoKSA9PT0gdWYudG9Mb3dlckNhc2UoKSkpIHtcbiAgICB0aHJvd0NlcEVycm9yKENFUEVycm9yQ29kZS5VRl9OQU9fRVhJU1RFKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXJDRVAgPSAoKSA9PiAoXG4gIHNvdXJjZTogT2JzZXJ2YWJsZTxzdHJpbmc+XG4pOiBPYnNlcnZhYmxlPHN0cmluZz4gPT5cbiAgbmV3IE9ic2VydmFibGUoKHN1YnNjcmliZXIpID0+XG4gICAgc291cmNlLnN1YnNjcmliZSh7XG4gICAgICBuZXh0OiAoY2VwKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKC9eWzAtOV0rJC8pO1xuICAgICAgICAgIGlmICghZWhTdHJpbmdWYWxpZGEoY2VwKSkge1xuICAgICAgICAgICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuQ0VQX1ZBWklPKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFyZWdleC50ZXN0KGNlcCkpIHtcbiAgICAgICAgICAgIHRocm93Q2VwRXJyb3IoQ0VQRXJyb3JDb2RlLkNFUF9JTlZBTElETyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjZXAubGVuZ3RoIDwgOCkge1xuICAgICAgICAgICAgdGhyb3dDZXBFcnJvcihDRVBFcnJvckNvZGUuQ0VQX01VSVRPX0NVUlRPKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNlcC5sZW5ndGggPiA4KSB7XG4gICAgICAgICAgICB0aHJvd0NlcEVycm9yKENFUEVycm9yQ29kZS5DRVBfTVVJVE9fTE9OR08pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoY2VwLnRyaW0oKSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXJyb3I6IChlcnJvcikgPT4gc3Vic2NyaWJlci5lcnJvcihlcnJvciksXG4gICAgICBjb21wbGV0ZTogKCkgPT4gc3Vic2NyaWJlci5jb21wbGV0ZSgpLFxuICAgIH0pXG4gICk7XG5cbmludGVyZmFjZSBFbmRlcmVjb1Blc3F1aXNhIHtcbiAgdWY6IHN0cmluZztcbiAgbG9ncmFkb3Vybzogc3RyaW5nO1xuICBtdW5pY2lwaW86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IHZhbGlkYXJFbmRlcmVjbyA9ICgpID0+IChcbiAgc291cmNlOiBPYnNlcnZhYmxlPEVuZGVyZWNvUGVzcXVpc2E+XG4pOiBPYnNlcnZhYmxlPEVuZGVyZWNvUGVzcXVpc2E+ID0+XG4gIG5ldyBPYnNlcnZhYmxlKChzdWJzY3JpYmVyKSA9PlxuICAgIHNvdXJjZS5zdWJzY3JpYmUoe1xuICAgICAgbmV4dDogKHsgdWYsIGxvZ3JhZG91cm8sIG11bmljaXBpbyB9KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFsaWRhclVGKHVmKTtcbiAgICAgICAgICB2YWxpZGFyTXVuaWNpcGlvKG11bmljaXBpbyk7XG4gICAgICAgICAgdmFsaWRhckxvZ3JhZG91cm8obG9ncmFkb3Vybyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICAgIHN1YnNjcmliZXIubmV4dCh7IHVmLCBsb2dyYWRvdXJvLCBtdW5pY2lwaW8gfSk7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IChlcnJvcikgPT4gc3Vic2NyaWJlci5lcnJvcihlcnJvciksXG4gICAgICBjb21wbGV0ZTogKCkgPT4gc3Vic2NyaWJlci5jb21wbGV0ZSgpLFxuICAgIH0pXG4gICk7XG4iXX0=