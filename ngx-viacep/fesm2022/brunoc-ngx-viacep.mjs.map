{"version":3,"file":"brunoc-ngx-viacep.mjs","sources":["../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.module.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error-code.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/constantes.ts","../../../projects/brunoc/ngx-viacep/src/lib/utils/index.ts","../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.service.ts","../../../projects/brunoc/ngx-viacep/src/public-api.ts","../../../projects/brunoc/ngx-viacep/src/brunoc-ngx-viacep.ts"],"sourcesContent":["import { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    HttpClientModule\n  ],\n  exports: [\n    \n  ]\n})\nexport class NgxViacepModule { }\n","// eslint-disable-next-line no-shadow\nexport enum CEPErrorCode {\n  CEP_NAO_ENCONTRADO,\n  CEP_VAZIO,\n  CEP_INVALIDO,\n  CEP_MUITO_CURTO,\n  CEP_MUITO_LONGO,\n  UF_VAZIA,\n  UF_MUITO_CURTA,\n  UF_MUITO_LONGA,\n  UF_NAO_EXISTE,\n  MUNICIPIO_VAZIO,\n  MUNICIPIO_MUITO_CURTO,\n  LOGRADOURO_VAZIO,\n  LOGRADOURO_MUITO_CURTO,\n  ERRO_SERVIDOR,\n}\n","import { CEPErrorCode } from './cep-error-code';\n\nexport class CEPError extends Error {\n  constructor(private code: CEPErrorCode) {\n    super(CEPErrorCode[code]);\n    Object.setPrototypeOf(this, CEPError.prototype);\n  }\n\n  /**\n   * Returns the Error code\n   */\n  getCode(): CEPErrorCode {\n    return this.code;\n  }\n}\n","export const BASE_URL = 'https://viacep.com.br/ws';\n\nexport const UFS_VALIDAS: string[] = [\n  'AC',\n  'AL',\n  'AM',\n  'AP',\n  'BA',\n  'CE',\n  'DF',\n  'ES',\n  'GO',\n  'MA',\n  'MG',\n  'MS',\n  'MT',\n  'PA',\n  'PB',\n  'PE',\n  'PI',\n  'PR',\n  'RJ',\n  'RN',\n  'RO',\n  'RR',\n  'RS',\n  'SC',\n  'SE',\n  'SP',\n  'TO',\n];\n","import { CEPError } from '../model/cep-error';\nimport { CEPErrorCode } from '../model/cep-error-code';\nimport { UFS_VALIDAS } from '../model/constantes';\nimport { Observable } from 'rxjs';\n\nconst throwCepError = (error: CEPErrorCode) => {\n  throw new CEPError(error);\n};\n\nconst ehStringValida = (data: string): boolean => !!data && data.trim() !== '';\n\nconst hasMinLength = (data: string, minLength: number): boolean =>\n  data.trim().length >= minLength;\n\nconst hasMaxLength = (data: string, maxLength: number): boolean =>\n  data.trim().length <= maxLength;\n\nconst validarMunicipio = (municipio: string): void => {\n  if (!ehStringValida(municipio)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_VAZIO);\n  }\n\n  if (!hasMinLength(municipio, 3)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_MUITO_CURTO);\n  }\n};\n\nconst validarLogradouro = (logradouro: string): void => {\n  if (!ehStringValida(logradouro)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_VAZIO);\n  }\n\n  if (!hasMinLength(logradouro, 3)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_MUITO_CURTO);\n  }\n};\n\nconst validarUF = (uf: string): void => {\n  if (!ehStringValida(uf)) {\n    throwCepError(CEPErrorCode.UF_VAZIA);\n  }\n\n  if (!hasMinLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_CURTA);\n  }\n\n  if (!hasMaxLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_LONGA);\n  }\n\n  if (!UFS_VALIDAS.some((it) => it.toLowerCase() === uf.toLowerCase())) {\n    throwCepError(CEPErrorCode.UF_NAO_EXISTE);\n  }\n};\n\nexport const validarCEP = () => (\n  source: Observable<string>\n): Observable<string> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: (cep) => {\n        try {\n          const regex = new RegExp(/^[0-9]+$/);\n          if (!ehStringValida(cep)) {\n            throwCepError(CEPErrorCode.CEP_VAZIO);\n          }\n          if (!regex.test(cep)) {\n            throwCepError(CEPErrorCode.CEP_INVALIDO);\n          }\n          if (cep.length < 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_CURTO);\n          }\n          if (cep.length > 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_LONGO);\n          }\n          subscriber.next(cep.trim());\n        } catch (e) {\n          subscriber.error(e);\n        }\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n\ninterface EnderecoPesquisa {\n  uf: string;\n  logradouro: string;\n  municipio: string;\n}\n\nexport const validarEndereco = () => (\n  source: Observable<EnderecoPesquisa>\n): Observable<EnderecoPesquisa> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: ({ uf, logradouro, municipio }) => {\n        try {\n          validarUF(uf);\n          validarMunicipio(municipio);\n          validarLogradouro(logradouro);\n        } catch (e) {\n          subscriber.error(e);\n        }\n        subscriber.next({ uf, logradouro, municipio });\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { Endereco } from './model/endereco';\nimport { CEPErrorCode } from './model/cep-error-code';\nimport { CEPError } from './model/cep-error';\nimport { BASE_URL } from './model/constantes';\nimport { validarCEP, validarEndereco } from './utils';\nimport { map, switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NgxViacepService {\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Busca o endere√ßo a partir do CEP\n   *\n   * @param cep\n   */\n  buscarPorCep(cep: string): Observable<Endereco> {\n    return of(cep).pipe(\n      validarCEP(),\n      switchMap((cepValido) =>\n        this.http.get<Endereco>(`${BASE_URL}/${cepValido}/json`)\n      ),\n      map((endereco) => {\n        if ('cep' in endereco) {\n          return endereco;\n        }\n        throw new CEPError(CEPErrorCode.CEP_NAO_ENCONTRADO);\n      })\n    );\n  }\n\n  /**\n   * Faz a busca aproximada\n   *\n   * @param uf\n   * @param municipio\n   * @param logradouro\n   */\n  buscarPorEndereco(\n    uf: string,\n    municipio: string,\n    logradouro: string\n  ): Observable<Endereco[]> {\n    return of({ uf, municipio, logradouro }).pipe(\n      validarEndereco(),\n      switchMap(() =>\n        this.http.get<Endereco[]>(\n          `${BASE_URL}/${uf}/${municipio}/${logradouro}/json`\n        )\n      )\n    );\n  }\n}\n","/*\n * Public API Surface of ngx-viacep\n */\n\nexport * from './lib/ngx-viacep.module';\nexport * from './lib/ngx-viacep.service';\nexport * from './lib/model/endereco';\nexport * from './lib/model/cep-error-code';\nexport * from './lib/model/cep-error';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}